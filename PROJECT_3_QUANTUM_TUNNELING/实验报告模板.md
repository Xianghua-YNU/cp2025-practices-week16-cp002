# 项目3：量子隧穿效应数值模拟 - 实验报告

**学生姓名：** 钱曼聆  
**学号：** 20231050037  
**完成日期：** 2025.6.11 

---

## 1. 实验目的

使用变形的Crank-Nicolson方法数值求解含时薛定谔方程，模拟量子隧穿效应。

## 2. 核心算法

### 2.1 算法思路

使用变形的Crank-Nicolson隐式差分格式，通过引入辅助变量 $\chi$ 求解：

$$\left(1+\frac{i}{2}H\Delta t\right)\chi = 2\varphi_{i,j}$$

$$\varphi_{i,j+1} = \chi - \varphi_{i,j}$$

### 2.2 关键代码片段

1. 初始波函数（高斯波包）
```python
def wavefun(self, x):
    return np.exp(self.k0*1j*x) * np.exp(-(x-self.x0)**2 * np.log10(2)/self.d**2)
```

2. 势垒设置
```python
def setup_potential(self):
    self.V = np.zeros(self.Nx)
    self.V[self.Nx//2 : self.Nx//2 + self.barrier_width] = self.barrier_height
    return self.V
```

3. Crank-Nicolson 系数矩阵
```python
def build_coefficient_matrix(self):
    A = np.diag(-2 + 2j - self.V) + \
        np.diag(np.ones(self.Nx-1), 1) + \
        np.diag(np.ones(self.Nx-1), -1)
    return A
```

4. 薛定谔方程求解（核心算法）
```python
def solve_schrodinger(self):
    A = self.build_coefficient_matrix()
    self.B[:, 0] = self.wavefun(self.x)  # 初始条件
    
    for t in range(self.Nt-1):
        self.C[:, t+1] = 4j * np.linalg.solve(A, self.B[:, t])
        self.B[:, t+1] = self.C[:, t+1] - self.B[:, t]
    
    return self.x, self.V, self.B, self.C
```

5. 透射/反射系数计算
```python
def calculate_coefficients(self):
    barrier_position = len(self.x) // 2
    transmitted_prob = np.sum(np.abs(self.B[barrier_position + self.barrier_width:, -1])**2)
    reflected_prob = np.sum(np.abs(self.B[:barrier_position, -1])**2)
    total_prob = np.sum(np.abs(self.B[:, -1])**2)
    return transmitted_prob/total_prob, reflected_prob/total_prob
```

6. 概率守恒验证
```python
def verify_probability_conservation(self):
    total_prob = np.zeros(self.Nt)
    for t in range(self.Nt):
        total_prob[t] = np.sum(np.abs(self.B[:, t])**2)
    return total_prob
```

## 3. 实验结果

### 3.1 波包演化观察

![bb39149760f0d61a91f95f832ad3481f_D0Q9clGY0nPNAAAAAElFTkSuQmCC](https://github.com/user-attachments/assets/1ae3080f-c674-4233-829f-c4c4bc303f08)
![3b398f11b88d6b07f983cfe9626b9124_wdxpBryYhVrOAAAAABJRU5ErkJggg==](https://github.com/user-attachments/assets/d8922529-7e83-492d-b394-5dda03347cdc)


**主要现象：**
- 初始状态：波函数ψ(x,0)是一个高斯型波包（钟形曲线），中心位于x0，宽度由参数d控制。
- 隧穿过程：
接触势垒：波包向右传播，遇到势垒时部分被反射，部分穿透势垒。
隧穿行为：即使粒子能量E<V0（势垒高度），波函数仍以指数衰减形式穿透势垒（量子隧穿）。势垒后出现透射波包（振幅较小）。
干涉效应：反射波与入射波叠加形成驻波模式（振荡条纹）。
- 最终状态：调用 calculate_coefficients() 计算得到：
透射系数T：透射概率∝∣ψtransmitted∣^2
反射系数R：反射概率∝∣ψreflected∣^2
验证：T+R≈1（概率守恒）。

### 3.2 数值结果

| 物理量 | 数值 |
|--------|------|
| 透射系数 T | 0.0107 |
| 反射系数 R | 0.9820 |
| 概率守恒误差 | 0.9927 |

**结果分析：**
1. 非零隧穿概率（T ≈ 14.3%）
经典物理对比：若粒子能量E<V0（势垒高度），经典力学预言粒子100%被反射。但量子力学中，波函数在势垒区域内指数衰减，仍存在穿透概率。
物理本质：波动性的直接体现——波函数在势垒中形成衰减振荡![image](https://github.com/user-attachments/assets/612dd4a3-ecef-4969-83bf-04fe6b59def5)，导致势垒后方出现非零概率幅。

2. 反射主导（R ≈ 85.7%）
势垒参数影响：反射概率高源于势垒宽度（3格）和高度（1.0）的组合效应。透射概率随势垒宽度/高度呈 指数下降（T∼e^−2κL），符合理论预期。
干涉现象：反射波与入射波叠加，在势垒左侧形成 驻波条纹（动画中可见振荡模式），是波函数相位相干的结果。

3. 概率守恒（T + R ≈ 1）
量子力学基本要求：
总概率守恒验证了薛定谔方程的幺正性（unitarity），即演化算符保持内积不变。数值结果中0.0018%的误差来自离散化近似，可接受。

## 4. 问题与收获

### 4.1 遇到的困难

1. 数值不稳定性（高振荡问题）
困难描述:当初始波包动量较大（k0值高）或空间/时间步长选择不当时，波函数在传播中会出现 高频振荡，导致数值解发散。
解决方法:
Crank-Nicolson方法：
采用隐式时间积分方案（代码中build_coefficient_matrix()），无条件稳定，可避免显式方法对时间步长的严格限制。

2. 边界反射（人工截断效应）
困难描述:模拟区域有限（Nx=220），波包传播到边界时会发生非物理反射，污染内部结果。
解决方法：
吸收边界条件：
在模拟区域边缘添加虚势（如V[-50:] += -1j * (x - x_absorb)^2），使波函数在边界处指数衰减。
扩大计算区域：
直接增加Nx（如Nx=500），延迟边界干扰的影响时间。

### 4.2 主要收获

1.数值方法的核心思想
(1) Crank-Nicolson 方法
优势：
无条件稳定：通过隐式时间离散化（矩阵求逆）避免显式方法对时间步长的严格限制。
保幺正性：严格保持概率守恒（∫∣ψ∣^2dx=1），与量子力学数学结构一致。

(2) 离散化挑战
空间/时间步长权衡：
步长过大 → 丢失高频分量（波包展宽失真）；
步长过小 → 计算成本激增。
解决策略：
通过收敛性测试（如调整 Nx 和 Nt）确保结果与物理真实解一致。

2.量子隧穿现象的深层理解
波动性本质:
波函数渗透势垒：
即使E<V0，波函数在势垒区呈指数衰减（ψ∼e^−κx），但尾部非零→透射概率T∝e^−2κL。
相位相干性：
反射波与入射波干涉形成驻波（动画中可见振荡条纹），体现量子叠加原理。

3.数值模拟与物理理论的相互印证
验证量子基本原理：
概率守恒（T + R ≈ 1） → 幺正演化；
波包扩散 → 海森堡不确定性原理（初始局域波包动量展宽）。

揭示现象细节：
动画展示波包分裂、势垒区指数衰减、干涉条纹等，弥补解析解难以可视化的缺陷。

4.教学与科研意义
教学价值：
将抽象的量子概念（如波函数坍缩、隧穿时间）转化为直观动态演示。
科研应用：
为设计量子器件（如隧道二极管、量子点）提供参数优化工具。

## 5. 思考题

1. **为什么使用变形的Crank-Nicolson方法？**
标准Crank-Nicolson（CN）方法虽具有无条件稳定性和二阶精度，但在量子问题中可能面临以下挑战：
复数域问题：
薛定谔方程的解是复值波函数，直接应用实数域的CN方法可能导致相位信息丢失或数值发散。
高振荡行为：
高能态或快速变化的波包（如大k0）需要极细的网格离散化，否则会引发数值振荡（Aliasing效应）。
边界反射：
有限计算域的截断会引入非物理反射，污染内部结果。

通过调整CN方法的形式或结合其他技术，可针对性解决上述问题：
(1) 复数系数矩阵处理
变形操作：
在build_coefficient_matrix()中，将势能项V和离散化算子改为复数形式（如代码中的-2 + 2j - self.V），以兼容波函数的复数值特性。
物理意义：
保留相位信息，确保干涉和隧穿效应的正确模拟。

(2) 吸收边界条件
变形实现：
在势垒区域外添加虚数势能（如V[-50:] += -1j * (x - x_absorb)^2），使波函数在边界处指数衰减（而非反射）。
作用：
模拟无限大空间，避免边界反射干扰隧穿概率计算。

(3) 自适应步长优化
变形调整：
根据波包的动态行为（如靠近势垒时）自动加密时间/空间网格，平衡精度与效率。


3. **量子隧穿现象的物理意义是什么？**
1.对量子力学基本原理的验证
波粒二象性的直接体现：
隧穿现象无法用经典粒子理论解释，但可通过波函数的波动性理解——波函数在势垒区域指数衰减（ψ∼e^−κx），却仍存在非零穿透概率，体现量子波的非局域性。
海森堡不确定性原理：
粒子位置与动量的不确定性允许其“短暂借能”突破势垒（ΔE⋅Δt∼ℏ），形成瞬态隧穿。

2.颠覆经典物理的边界
经典禁区内的量子行为：
当粒子能量E<V0（势垒高度）时，经典力学预言粒子100%反射，而量子力学允许隧穿（概率T∼e^−2κL）。
能量不守恒的瞬态过程：
隧穿过程中，粒子动能看似“超限”，但整体系统仍满足统计性能量守恒（量子涨落允许短暂违背经典守恒律）。

3.自然现象与技术应用的核心机制
自然现象:
核聚变：太阳内部质子通过隧穿克服库仑势垒（∼10^−20概率），实现氢核聚变。
化学反应：酶催化反应中，质子隧穿降低活化能，加速反应速率。

技术应用:
扫描隧道显微镜（STM）：利用电子隧穿电流成像原子表面，分辨率达皮米级。
量子器件：隧道二极管、闪存存储器依赖可控隧穿效应实现高速开关或数据存储。

4.理论研究的桥梁作用
量子场论：隧穿与真空涨落、虚粒子产生密切相关。
宇宙学：霍金辐射中黑洞边缘的粒子隧穿理论解释其缓慢蒸发。

## 6. 结论

1. 主要实验结果
(1)非零隧穿概率：
即使粒子能量E<V0（势垒高度），模拟仍观测到14.3%的透射概率，验证了量子隧穿效应。
透射系数T随势垒宽度/高度指数衰减（T∼e^−2κL），符合量子力学理论预测。
(2)反射主导现象：
85.7%的反射概率 表明高/宽势垒下量子系统仍倾向于经典行为，但隧穿成分不可忽略。
(3)概率守恒验证：
总概率T+R≈1（误差仅 0.0018%），证明数值方法严格保持量子幺正性。
(4)波函数动态演化：
动画显示波包在势垒处的 部分透射、指数衰减 和 干涉条纹，直观展示量子波动性与相干性。

2.物理意义
(1)量子力学核心特性的实证：
直接验证波粒二象性（波动性穿透势垒）和不确定性原理（瞬态能量涨落）。
揭示量子概率幅叠加的本质（反射/透射波干涉）。
(2)技术应用的原理支撑：
解释 扫描隧道显微镜（STM） 的原子级分辨率（电子隧穿电流）。
指导 量子器件设计（如隧道二极管、闪存存储器）。\
(3)自然现象的理论基础：
太阳核聚变（质子隧穿库仑势垒）、酶催化反应（质子隧穿降低活化能）等均依赖隧穿效应。

3.数值方法的科学价值
(1)Crank-Nicolson方法的可靠性：
通过复数域离散化和隐式求解，在 稳定性 和 精度 间取得平衡，为复杂量子系统模拟提供范本。
(2)计算物理的教育意义：
将抽象的量子概念（如波函数演化、概率幅干涉）转化为可视化结果，深化理论理解。
