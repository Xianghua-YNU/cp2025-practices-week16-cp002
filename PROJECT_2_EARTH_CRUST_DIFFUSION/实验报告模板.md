# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [曹玉琴]

**学号：** [20231050001]

**完成日期：** [2025.6.11]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

- 空间和时间离散化方案
- 差分方程的具体形式
- 边界条件的处理方法
- 稳定性条件的考虑

```
空间和时间离散化方案：
空间离散化：采用均匀网格，深度方向上从地表 (0m) 到 20m 深处，步长为 h=1.0m，共 M=21 个网格点。
时间离散化：采用均匀时间步长，时间步长为 a²，单位为天，总模拟时间为 years=10 年，每年 N=366 个时间步。
```

```
差分方程的具体形式：
对于热扩散方程 ∂T/∂t = D・∂²T/∂z²，使用显式差分格式：
T(z, t+Δt) = T(z, t) + r·[T(z+Δz, t) + T(z-Δz, t) - 2·T(z, t)]
其中稳定性参数 r = D・Δt/(Δz)²，在代码中表示为 r = D・a²/h²。
```

```
边界条件的处理方法：
地表边界条件 (Dirichlet 边界)：T (0, t) = A + B・sin (2πt/TAU)，即周期性温度波动。
底部边界条件 (Dirichlet 边界)：T (DEPTH_MAX, t) = T_BOTTOM，即恒定温度 11°C。
初始条件：所有深度初始温度为 T_INITIAL=10°C。
```

```
稳定性条件的考虑：
显式差分格式的稳定性条件为 r ≤ 0.5，即 D・Δt/(Δz)² ≤ 0.5。
代码中通过参数 a 控制时间步长，以满足稳定性要求。
```


**稳定性分析：**

- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 时间步长选择的限制条件

```
稳定性参数 r 的值：
代码中稳定性参数 r = D・a²/h²，其中 D=0.1 m²/day，h=1.0m。
当 a=1.0 时，r = 0.1・1²/1² = 0.1，满足稳定性条件 r ≤ 0.5。
```

```
时间步长选择的限制条件：
根据稳定性条件 r ≤ 0.5，可得时间步长限制：
Δt ≤ 0.5·(Δz)²/D
代入参数 D=0.1 m²/day，Δz=1.0m，得：
Δt ≤ 0.5·1²/0.1 = 5 天
代码中时间步长为 a²，当 a=1.0 时，时间步长为 1 天，满足稳定性要求。若 a 增大，需确保 a² ≤ 5 以维持稳定性。
```

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
- 时间步数: $n_t$ =  [366]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.1000]

### 4.2 图表结果：季节性温度轮廓图
![Figure_1](https://github.com/user-attachments/assets/f9b65751-dafc-4626-92ef-5efac2902d1e)

**图表分析：**
- 描述四个季节温度轮廓的差异
- 分析温度振幅随深度的衰减规律
- 讨论季节性影响的穿透深度

地表温度在四季变化最剧烈，波动幅度约为 $[ -2°C, 22°C ]$

深度增加后，温度波动逐渐衰减，到约 $z=8\text{m}$ 以后几乎不再有显著变化

季节性温度的穿透深度（温度变化<1°C）约为 $10-12$ 米，符合实际观测的地温梯度规律

---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

模拟结果清晰显示出热量在地壳中的“扩散性传播”特征：地表温度的季节性变化会随时间逐步向下扩散，但在传播过程中会被热扩散过程“平滑”，导致振幅衰减。

地表变化的响应具有“延迟性”：较深处的温度变化滞后于地表。


### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

深层土壤或岩层的热扩散作用会逐渐削弱高频（如年变化）的温度信号，导致温度变化幅度随着深度增加而迅速减小。这种现象在工程地质、地热开发和农业领域具有广泛应用。

例如：

地下室或地窖常年保持恒温；

深层地温探测可用于重建古气候信息；

地下热泵系统利用地壳稳定热源进行供暖制冷。

3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

显式格式实现简单，计算成本较低，适合短时间模拟和教学实验；但稳定性条件严格，时间步长必须非常小。

隐式格式（如 Crank-Nicolson）虽然每步需解线性方程组，但具备无条件稳定性，适合模拟较长时间或较细空间分辨率的问题。

对于大尺度或非线性耦合问题，通常选择隐式格式以节省总计算时间。



---

## 6. 核心代码片段（可选）

```python
import numpy as np
import matplotlib.pyplot as plt

# 物理常数
D = 0.1  # 热扩散率 (m^2/day)
A = 10.0  # 年平均地表温度 (°C)
B = 12.0  # 地表温度振幅 (°C)
TAU = 365.0  # 年周期 (days)
T_BOTTOM = 11.0  # 20米深处温度 (°C)
T_INITIAL = 10.0  # 初始温度 (°C)
DEPTH_MAX = 20.0  # 最大深度 (m)


def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    """
    求解地壳热扩散方程 (显式差分格式)
    
    参数:
        h (float): 空间步长 (m)
        a (float): 时间步长比例因子
        M (int): 深度方向网格点数
        N (int): 时间步数
        years (int): 总模拟年数
    
    返回:
        tuple: (depth_array, temperature_matrix)
            - depth_array (ndarray): 深度数组 (m)
            - temperature_matrix (ndarray): 温度矩阵 [time, depth]
    """
    # 计算稳定性参数
    r = D * a**2 / h**2  # 修正题目里的稳定性参数计算，通常显式差分稳定性条件是r = D*dt/(dx**2)
    print(f"**基本计算参数：**")
    print(f"- 网格点数：$n_z$ = {M}")
    print(f"- 时间步数：$n_t$ = {N}")
    print(f"- 模拟总时间：{years} 年")
    print(f"- 稳定性参数：$r$ = {r:.4f}")
    
    # 初始化温度矩阵
    T = np.zeros((M, N)) + T_INITIAL
    T[-1, :] = T_BOTTOM  # 底部边界条件
    
    # 时间步进循环
    for year in range(years):
        for j in range(1, N - 1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
            
            # 显式差分格式（修正后，基于正确的r计算逻辑 ）
            T[1:-1, j + 1] = T[1:-1, j] + (D / h**2) * (T[2:, j] + T[:-2, j] - 2 * T[1:-1, j]) * a**2
    
    # 创建深度数组
    depth = np.arange(0, DEPTH_MAX + h, h)
    
    return depth, T


def plot_seasonal_profiles(depth, temperature, seasons=[90, 180, 270, 365]):
    """
    绘制季节性温度轮廓
    
    参数:
        depth (ndarray): 深度数组
        temperature (ndarray): 温度矩阵
        seasons (list): 季节时间点 (days)
    """
    plt.figure(figsize=(10, 8))
    
    # 绘制各季节的温度轮廓
    for i, day in enumerate(seasons):
        plt.plot(depth, temperature[:, day],
                 label=f'Day {day}', linewidth=2)
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()
    
    plt.show()


if __name__ == "__main__":
    # 运行模拟，可根据需要调整M、N、years等参数
    depth, T = solve_earth_crust_diffusion(M=21, N=366, years=10)
    
    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)
```

